<GraffitiQuery
    v-slot="{ results: waves, isPolling }"
    :channels="[ 'https://graffiti.garden' ]"
    :query="{
        properties: {
            value: {
                properties: {
                    type: { enum: ['Wave'] }
                },
                required: ['type']
            }
        }
    }"
>
    <template v-if="$graffitiSession.isReady">
        <button
            v-if="!waves.some(
                wave => wave.webId === $graffitiSession.webId
            )"
            @click="$graffiti.put({
                value: { type: 'Wave' },
                channels: [ 'https://graffiti.garden' ]
            })"
        >
            ğŸ‘‹
        </button>
        <button
            v-else
            class="waving"
            @click="waves.filter(
                wave => wave.webId === $graffitiSession.webId
            ).map(wave => $graffiti.delete(wave))"
        >
            ğŸ‘‹
        </button>
    </template>
    <template v-else>
        <p>To wave ğŸ‘‹ you need to be logged in.</p>
        <p>Open the session manager below.</p>
    </template>

    <p v-if="isPolling">Loading...</p>

    <p v-else>{{ waves.length }} people have waved from this page!</p>
</GraffitiQuery>
